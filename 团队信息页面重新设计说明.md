# 📋 团队信息采集页面 - 重新设计说明

## ✅ 重新设计完成

根据新的需求，已完成页面的重新设计和实现。

---

## 🎯 新需求实现

### 1. 炉号 - 只能输入数字 ✅

**实现方式：**
- `inputType="number"` - 限制只能输入数字
- 数字键盘自动弹出
- 无需任何字母前缀

**示例：**
- ✅ 正确：1、2、3、100
- ❌ 错误：A1、B2（不再支持）

### 2. 年级 - 下拉框选择 ✅

**实现方式：**
- 使用 `Spinner` 组件
- 预设选项：高一、高二
- 圆角背景样式

**选项列表：**
1. 请选择年级（默认提示）
2. 高一
3. 高二

### 3. 班级 - 下拉框选择 ✅

**实现方式：**
- 使用 `Spinner` 组件
- 预设1-25班
- 圆角背景样式

**选项列表：**
1. 请选择班级（默认提示）
2. 1班
3. 2班
4. ...
26. 25班

### 4. 小组人数 - 限制1-15人 ✅

**实现方式：**
- `inputType="number"` - 只能输入数字
- `maxLength="2"` - 最多2位数字
- 实时验证范围
- 超过15自动调整为15

**验证规则：**
- ✅ 1-15：有效范围
- ❌ 0：提示错误
- ❌ 16+：自动改为15

### 5. 人员姓名 - 动态生成输入框 ✅

**实现方式：**
- 根据小组人数动态生成相应数量的输入框
- 每个成员一个独立输入框
- 自动编号（成员1、成员2...）
- 实时更新

**交互流程：**
1. 用户输入小组人数（如：5）
2. 系统自动生成5个姓名输入框
3. 每个输入框有序号标识
4. 用户修改人数时，输入框数量自动调整

---

## 🎨 页面布局

### 横屏布局（10-11寸平板优化）

```
┌─────────────────────────────────────────────────────┐
│  团队信息登记                                         │
│  请填写您的小组信息                                    │
├─────────────────────┬───────────────────────────────┤
│  左侧表单区          │  右侧人员姓名区                 │
│                     │                               │
│  🏫 学校名称        │  人员姓名                      │
│  ┌───────────────┐  │  ┌─────────────────────────┐ │
│  │               │  │  │ ✏️ 成员1                │ │
│  └───────────────┘  │  └─────────────────────────┘ │
│                     │  ┌─────────────────────────┐ │
│  📅 年级           │  │ ✏️ 成员2                │ │
│  ┌───────────────┐  │  └─────────────────────────┘ │
│  │ 高一 ▼       │  │  ┌─────────────────────────┐ │
│  └───────────────┘  │  │ ✏️ 成员3                │ │
│                     │  └─────────────────────────┘ │
│  📋 班级           │  ┌─────────────────────────┐ │
│  ┌───────────────┐  │  │ ✏️ 成员4                │ │
│  │ 1班 ▼        │  │  └─────────────────────────┘ │
│  └───────────────┘  │  ┌─────────────────────────┐ │
│                     │  │ ✏️ 成员5                │ │
│  🧭 炉号（纯数字）  │  └─────────────────────────┘ │
│  ┌───────────────┐  │                               │
│  │               │  │  （滚动查看更多）              │
│  └───────────────┘  │                               │
│                     │                               │
│  👥 小组人数        │                               │
│  ┌───────────────┐  │                               │
│  │            人 │  │                               │
│  └───────────────┘  │                               │
└─────────────────────┴───────────────────────────────┘
│          [ 重置 ]    [ 开始野炊 ]                    │
└─────────────────────────────────────────────────────┘
```

**布局特点：**
- 📱 左右分栏设计
- 📝 左侧：基本信息（学校、年级、班级、炉号、人数）
- 👥 右侧：人员姓名（动态生成）
- 🎯 充分利用横屏空间

### 竖屏布局（手机适配）

```
┌─────────────────────┐
│  团队信息登记        │
│  请填写您的小组信息  │
├─────────────────────┤
│  🏫 学校名称        │
│  ┌───────────────┐  │
│  │               │  │
│  └───────────────┘  │
│                     │
│  📅 年级           │
│  ┌───────────────┐  │
│  │ 高一 ▼       │  │
│  └───────────────┘  │
│                     │
│  📋 班级           │
│  ┌───────────────┐  │
│  │ 1班 ▼        │  │
│  └───────────────┘  │
│                     │
│  🧭 炉号           │
│  ┌───────────────┐  │
│  │               │  │
│  └───────────────┘  │
│                     │
│  👥 小组人数        │
│  ┌───────────────┐  │
│  │            人 │  │
│  └───────────────┘  │
│                     │
│  人员姓名           │
│  ┌───────────────┐  │
│  │ ✏️ 成员1     │  │
│  └───────────────┘  │
│  ┌───────────────┐  │
│  │ ✏️ 成员2     │  │
│  └───────────────┘  │
│  ...                │
│                     │
│  [ 重置 ][ 开始 ]   │
└─────────────────────┘
```

**布局特点：**
- 📝 单列纵向布局
- 📜 可滚动查看所有内容
- 🔘 底部等宽按钮

---

## 💻 技术实现

### 1. Spinner 下拉框

**年级下拉框：**
```kotlin
// 设置适配器
val gradeAdapter = ArrayAdapter.createFromResource(
    this,
    R.array.grades,  // 年级数组
    android.R.layout.simple_spinner_item
)
gradeAdapter.setDropDownViewResource(
    android.R.layout.simple_spinner_dropdown_item
)
binding.gradeSpinner.adapter = gradeAdapter
```

**班级下拉框：**
```kotlin
// 设置适配器
val classAdapter = ArrayAdapter.createFromResource(
    this,
    R.array.classes,  // 班级数组（1-25班）
    android.R.layout.simple_spinner_item
)
classAdapter.setDropDownViewResource(
    android.R.layout.simple_spinner_dropdown_item
)
binding.classSpinner.adapter = classAdapter
```

### 2. 动态生成输入框

**监听人数输入：**
```kotlin
binding.memberCountInput.addTextChangedListener(object : TextWatcher {
    override fun afterTextChanged(s: Editable?) {
        val count = s.toString().toIntOrNull() ?: 0
        if (count in 1..15) {
            generateMemberNameInputs(count)  // 生成输入框
        } else if (count > 15) {
            // 超过15自动调整
            binding.memberCountInput.setText("15")
        }
    }
})
```

**生成输入框：**
```kotlin
private fun generateMemberNameInputs(count: Int) {
    // 清空现有输入框
    clearMemberNameInputs()
    
    // 生成指定数量的输入框
    for (i in 1..count) {
        val textInputLayout = TextInputLayout(this)
        val editText = TextInputEditText(this)
        
        textInputLayout.hint = "成员 $i"
        textInputLayout.addView(editText)
        
        binding.memberNamesContainer.addView(textInputLayout)
        memberNameInputs.add(editText)
    }
}
```

### 3. 数据验证

**验证逻辑：**
```kotlin
private fun validateAndSaveInfo(): Boolean {
    val missingFields = mutableListOf<String>()
    
    // 1. 验证学校
    if (schoolInput.isBlank()) missingFields.add("学校")
    
    // 2. 验证年级（下拉框）
    if (gradeSpinner.selectedItemPosition == 0) 
        missingFields.add("年级")
    
    // 3. 验证班级（下拉框）
    if (classSpinner.selectedItemPosition == 0) 
        missingFields.add("班级")
    
    // 4. 验证炉号
    if (stoveInput.isBlank()) missingFields.add("炉号")
    
    // 5. 验证人数（1-15）
    if (memberCount !in 1..15) 
        missingFields.add("小组人数（1-15人）")
    
    // 6. 验证每个成员姓名
    for ((index, input) in memberNameInputs.withIndex()) {
        if (input.text.isBlank()) 
            missingFields.add("成员${index + 1}姓名")
    }
    
    return missingFields.isEmpty()
}
```

---

## 📝 字段详解

### 1. 学校 🏫

| 属性 | 值 |
|------|-----|
| 类型 | 文本输入 |
| 图标 | 📍 地图图标 |
| 颜色 | 橙色 |
| 验证 | 必填 |

### 2. 年级 📅

| 属性 | 值 |
|------|-----|
| 类型 | 下拉框 (Spinner) |
| 选项 | 高一、高二 |
| 默认 | 请选择年级 |
| 验证 | 必须选择（非默认项） |

### 3. 班级 📋

| 属性 | 值 |
|------|-----|
| 类型 | 下拉框 (Spinner) |
| 选项 | 1班~25班 |
| 默认 | 请选择班级 |
| 验证 | 必须选择（非默认项） |

### 4. 炉号 🧭

| 属性 | 值 |
|------|-----|
| 类型 | 数字输入 |
| 图标 | 🧭 指南针图标 |
| 颜色 | 红色 |
| 限制 | 只能输入数字 |
| 验证 | 必填 |
| 示例 | 1, 2, 3, 100 |

### 5. 小组人数 👥

| 属性 | 值 |
|------|-----|
| 类型 | 数字输入 |
| 图标 | 📝 日程图标 |
| 颜色 | 红色 |
| 限制 | 1-15人 |
| 最大长度 | 2位数字 |
| 后缀 | "人" |
| 验证 | 必须在1-15范围内 |
| 自动调整 | 超过15自动改为15 |

### 6. 人员姓名 ✏️

| 属性 | 值 |
|------|-----|
| 类型 | 动态生成的文本输入框 |
| 图标 | ✏️ 编辑图标 |
| 颜色 | 红色 |
| 数量 | 根据小组人数动态生成 |
| 标签 | 成员1、成员2、成员3... |
| 验证 | 每个输入框必填 |

---

## 🔍 用户体验流程

### 完整填写流程

```
1. 填写学校名称
   └─> 手动输入文字
   
2. 选择年级
   └─> 点击下拉框 → 选择"高一"或"高二"
   
3. 选择班级
   └─> 点击下拉框 → 选择"1班"到"25班"
   
4. 填写炉号
   └─> 输入纯数字（如：1、2、100）
   
5. 填写小组人数
   └─> 输入1-15之间的数字
   └─> 🎯 系统自动生成相应数量的姓名输入框
   
6. 填写成员姓名
   └─> 在动态生成的输入框中填写每个成员的姓名
   └─> 成员1、成员2、成员3...
   
7. 点击"开始野炊"
   └─> 系统验证所有字段
   └─> 显示确认对话框
   └─> 确认后保存信息
```

### 动态交互示例

**场景1：输入5人**
```
用户：输入 5
系统：自动生成5个输入框
      ┌─────────────┐
      │ 成员1       │
      └─────────────┘
      ┌─────────────┐
      │ 成员2       │
      └─────────────┘
      ┌─────────────┐
      │ 成员3       │
      └─────────────┘
      ┌─────────────┐
      │ 成员4       │
      └─────────────┘
      ┌─────────────┐
      │ 成员5       │
      └─────────────┘
```

**场景2：修改为3人**
```
用户：修改为 3
系统：自动调整为3个输入框
      ┌─────────────┐
      │ 成员1       │
      └─────────────┘
      ┌─────────────┐
      │ 成员2       │
      └─────────────┘
      ┌─────────────┐
      │ 成员3       │
      └─────────────┘
      （原有的4、5号输入框被移除）
```

**场景3：输入20（超过限制）**
```
用户：输入 20
系统：自动调整为 15
      显示提示："小组人数必须在1-15之间"
      生成15个输入框
```

---

## ✅ 验证规则

### 提交时验证

| 字段 | 验证规则 | 错误提示 |
|------|----------|----------|
| 学校 | 不能为空 | "请填写：学校" |
| 年级 | 必须选择（非"请选择年级"） | "请填写：年级" |
| 班级 | 必须选择（非"请选择班级"） | "请填写：班级" |
| 炉号 | 不能为空，只能是数字 | "请填写：炉号" |
| 人数 | 必须在1-15之间 | "请填写：小组人数（1-15人）" |
| 姓名 | 每个输入框都不能为空 | "请填写：成员X姓名" |

### 实时验证

| 场景 | 触发时机 | 系统响应 |
|------|----------|----------|
| 人数超过15 | 输入时 | 自动改为15，显示Toast |
| 人数为0或负数 | 提交时 | 显示错误提示 |
| 人数改变 | 输入时 | 动态生成/移除输入框 |
| 炉号输入字母 | 输入时 | 自动拒绝（数字键盘） |

---

## 🎨 视觉设计

### 下拉框样式

**Spinner Background：**
- 圆角：12dp
- 边框：1dp 灰色
- 背景：白色
- 内边距：16dp
- 下拉箭头：系统默认

### 动态输入框样式

**TextInputLayout：**
- 样式：Outline（描边）
- 圆角：12dp
- 图标：✏️ 编辑图标（红色）
- 标签：成员1、成员2...
- 间距：12dp（竖屏）/ 16dp（横屏）

### 颜色方案

| 元素 | 颜色 | 用途 |
|------|------|------|
| 学校图标 | 🟠 橙色 | 区分基本信息 |
| 炉号图标 | 🔴 红色 | 区分小组信息 |
| 人数图标 | 🔴 红色 | 区分小组信息 |
| 姓名图标 | 🔴 红色 | 区分小组信息 |
| 主按钮 | 🟠 橙色 | 主要操作 |
| 次按钮 | 描边橙色 | 次要操作 |

---

## 📊 文件清单

### 新增文件

1. ✅ `app/src/main/res/drawable/spinner_background.xml`
   - Spinner下拉框背景样式

### 修改文件

1. ✅ `app/src/main/res/layout-land/activity_main.xml`
   - 横屏布局（重新设计）
   - 左右分栏
   - 动态人员姓名区域

2. ✅ `app/src/main/res/layout/activity_main.xml`
   - 竖屏布局（重新设计）
   - 单列布局
   - 动态人员姓名区域

3. ✅ `app/src/main/res/values/strings.xml`
   - 添加年级数组（高一、高二）
   - 添加班级数组（1-25班）
   - 修改提示文字
   - 添加成员标签格式

4. ✅ `app/src/main/java/com/campcooking/ar/MainActivity.kt`
   - Spinner适配器设置
   - 动态生成输入框逻辑
   - TextWatcher监听人数变化
   - 验证逻辑更新

---

## 🧪 测试场景

### 功能测试

**测试1：下拉框功能**
- ✅ 年级下拉框显示正确选项
- ✅ 班级下拉框显示1-25班
- ✅ 选择后值保存正确

**测试2：炉号输入**
- ✅ 只能输入数字
- ✅ 数字键盘自动弹出
- ✅ 不能输入字母

**测试3：动态输入框**
- ✅ 输入5，生成5个输入框
- ✅ 输入3，生成3个输入框
- ✅ 修改人数，输入框数量自动调整
- ✅ 每个输入框有正确序号

**测试4：人数范围限制**
- ✅ 输入1-15，正常工作
- ✅ 输入16，自动调整为15
- ✅ 输入20，自动调整为15
- ✅ 输入0，提交时显示错误

**测试5：验证功能**
- ✅ 未选择年级，显示错误
- ✅ 未选择班级，显示错误
- ✅ 未填写某个成员姓名，显示具体哪个成员

**测试6：重置功能**
- ✅ 重置清空所有输入
- ✅ 重置清空动态生成的输入框
- ✅ 下拉框恢复到默认选项

### 边界测试

| 测试场景 | 输入 | 预期结果 |
|---------|------|----------|
| 最小人数 | 1 | 生成1个输入框 |
| 最大人数 | 15 | 生成15个输入框 |
| 超过最大 | 20 | 自动改为15 |
| 零人数 | 0 | 提交时错误 |
| 空人数 | 清空 | 移除所有输入框 |

### 用户体验测试

- ✅ 输入框生成流畅无卡顿
- ✅ 滚动查看所有内容
- ✅ 输入框序号清晰可见
- ✅ 错误提示准确明确
- ✅ 下拉框选项显示完整

---

## 💡 使用建议

### 最佳实践

**填写顺序：**
1. 先填写学校、选择年级和班级
2. 再填写炉号
3. 然后输入小组人数
4. 最后填写每个成员的姓名

**人数建议：**
- 建议4-6人一组
- 最少1人，最多15人
- 人数确定后再填写姓名

**炉号格式：**
- 纯数字格式
- 示例：1、2、3、10、100
- 不再使用字母前缀

**姓名填写：**
- 每个输入框填写一个人的姓名
- 输入框按序号排列
- 建议按重要性或字母顺序填写

---

## 🚀 后续优化建议

### 短期优化

1. **添加年级选项**
   - 可扩展到高三
   - 或支持初中年级

2. **炉号范围限制**
   - 限制炉号范围（如1-100）
   - 防止输入过大数字

3. **姓名格式验证**
   - 检查是否包含数字
   - 检查长度是否合理

### 中期功能

1. **保存草稿**
   - 自动保存填写进度
   - 下次打开自动恢复

2. **快速填充**
   - 扫码填充炉号
   - 历史记录快速选择

3. **批量导入**
   - 从文件导入成员名单
   - Excel/CSV格式支持

### 长期规划

1. **智能验证**
   - 检查姓名是否重复
   - 检查炉号是否已被占用

2. **数据同步**
   - 与服务器实时同步
   - 教师端查看各小组情况

3. **统计分析**
   - 各班级参与情况
   - 各炉号使用率
   - 人数分布统计

---

## 📱 截图说明

### 横屏布局截图位置

```
1. 空白状态（未填写）
2. 选择下拉框时的状态
3. 输入5人后的动态输入框状态
4. 填写完整后的状态
5. 确认对话框
```

### 竖屏布局截图位置

```
1. 页面顶部（标题+学校）
2. 中部（下拉框区域）
3. 下部（动态输入框区域）
4. 底部（按钮区域）
```

---

## 🎓 技术要点

### 关键技术

1. **Spinner 下拉框**
   - ArrayAdapter 适配器
   - 自定义背景样式
   - 选项数组定义

2. **TextWatcher 监听**
   - 实时监听输入变化
   - 动态响应用户输入
   - 范围验证

3. **动态视图生成**
   - 程序化创建 View
   - LayoutParams 设置
   - 父容器管理

4. **数据收集**
   - List 存储输入框引用
   - 遍历收集所有输入
   - 格式化输出

---

**创建日期：** 2025-12-31  
**版本：** v2.0  
**功能：** 团队信息采集页面（重新设计）  
**状态：** ✅ 已完成

**主要改进：**
- ✅ 年级和班级改用下拉框
- ✅ 炉号改为纯数字输入
- ✅ 小组人数限制1-15人
- ✅ 姓名输入框动态生成
- ✅ 更好的用户体验

