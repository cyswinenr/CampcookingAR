# 📁 外部存储视频使用说明

## ✅ 已改为外部存储方案

现在视频文件存放在平板的 **Documents/CampcookingAR/Videos/** 文件夹中，不再放在项目的 `res/raw/` 文件夹。

---

## 🎯 方案优点

### ✅ 不需要同步大文件
- 视频文件不会上传到 GitHub
- 项目同步速度更快
- 节省 GitHub 存储空间

### ✅ 更新视频更方便
- 通过 USB 直接复制视频到平板
- 使用文件管理器即可管理视频
- 不需要重新编译应用（只需修改配置后编译一次）

### ✅ 支持中文文件名
- 视频文件可以使用中文命名
- 例如：`生火技巧.mp4`、`砍鸡的方法.mp4`

---

## 📂 视频存放位置

### 完整路径：
```
内部存储/Documents/CampcookingAR/Videos/
```

### 在 Windows 文件资源管理器中（通过 USB 连接）：
```
此电脑 > [平板设备名] > 内部存储 > Documents > CampcookingAR > Videos
```

### 在平板文件管理器中：
```
内部存储 > Documents > CampcookingAR > Videos
```

---

## 🚀 如何使用

### 第一步：准备视频文件

1. **准备好你的视频文件**
   - 格式：`.mp4`（推荐）
   - 命名：可以使用中文，例如：
     - `生火技巧.mp4`
     - `砍鸡的方法.mp4`
     - `砍排骨方法.mp4`

### 第二步：复制视频到平板

#### 方法 1：通过 USB 连接（推荐）

1. **连接平板到电脑**
   - 使用 USB 数据线连接平板和电脑
   - 在平板上选择"文件传输"模式

2. **打开文件资源管理器**
   - Windows：`Win + E` 打开文件资源管理器
   - 找到你的平板设备

3. **导航到目标文件夹**
   ```
   [平板设备] > 内部存储 > Documents > CampcookingAR > Videos
   ```
   
   > 💡 如果 `CampcookingAR` 或 `Videos` 文件夹不存在：
   > - 运行一次应用，会自动创建文件夹
   > - 或手动创建这两个文件夹

4. **复制视频文件**
   - 将准备好的视频文件复制到 `Videos` 文件夹中
   - 等待复制完成

#### 方法 2：通过平板文件管理器

1. **下载视频到平板**
   - 从网盘、邮件等下载视频到平板的 `Download` 文件夹

2. **打开文件管理器**
   - 在平板上打开"文件管理"应用

3. **移动视频文件**
   - 找到下载的视频文件
   - 长按选中，选择"移动"或"复制"
   - 导航到：`内部存储 > Documents > CampcookingAR > Videos`
   - 粘贴文件

### 第三步：配置视频信息

1. **打开 VideoConfig.kt 文件**
   ```
   app/src/main/java/com/campcooking/ar/config/VideoConfig.kt
   ```

2. **添加视频配置**

找到 `getVideoList()` 函数，添加视频配置：

```kotlin
fun getVideoList(): List<Video> {
    return listOf(
        // 视频1：生火技巧
        Video(
            id = 1,
            title = "生火技巧",
            description = "学习如何快速安全地生火，掌握柴火的摆放和点火技巧。",
            duration = "1:27",
            fileName = "生火技巧.mp4",  // ← 填写实际的文件名
            category = "基础技能",
            order = 1
        ),
        
        // 添加更多视频...
        Video(
            id = 2,
            title = "新视频标题",
            description = "新视频描述",
            duration = "3:00",
            fileName = "新视频文件名.mp4",  // ← 与实际文件名完全一致
            category = "分类名称",
            order = 2
        )
    )
}
```

3. **重要字段说明**

| 字段 | 说明 | 示例 |
|------|------|------|
| `id` | 唯一ID，不能重复 | `1`, `2`, `3` |
| `title` | 视频标题（显示在列表中） | `"生火技巧"` |
| `description` | 视频描述（显示在详情中） | `"学习如何..."` |
| `duration` | 视频时长（显示用） | `"1:27"`, `"3:45"` |
| `fileName` | **文件名（必须与实际文件名完全一致）** | `"生火技巧.mp4"` |
| `category` | 分类（可用于筛选） | `"基础技能"` |
| `order` | 排序（数字越小越靠前） | `1`, `2`, `3` |

### 第四步：编译运行

1. **Clean 项目**
   ```
   Build → Clean Project
   ```

2. **Rebuild 项目**
   ```
   Build → Rebuild Project
   ```

3. **运行应用**
   - 点击运行按钮 ▶️
   - 应用会自动检测视频文件夹
   - 如果视频文件存在，会自动播放

---

## 📝 文件夹结构示例

```
内部存储/
└── Documents/
    └── CampcookingAR/
        └── Videos/
            ├── 生火技巧.mp4
            ├── 砍鸡的方法.mp4
            ├── 砍排骨方法.mp4
            ├── 炒菜技巧.mp4
            └── ... 更多视频
```

---

## 🎬 完整示例

### 场景：添加一个新视频 "炒菜技巧"

#### 1. 准备视频文件
- 文件名：`炒菜技巧.mp4`
- 时长：4 分 30 秒

#### 2. 复制到平板
```
Documents/CampcookingAR/Videos/炒菜技巧.mp4
```

#### 3. 在 VideoConfig.kt 中添加配置

```kotlin
fun getVideoList(): List<Video> {
    return listOf(
        // ... 其他视频 ...
        
        // 新增：炒菜技巧
        Video(
            id = 4,
            title = "炒菜技巧",
            description = "学习如何正确炒菜，掌握火候和调味技巧。",
            duration = "4:30",
            fileName = "炒菜技巧.mp4",
            category = "烹饪技能",
            order = 4
        )
    )
}
```

#### 4. 编译运行
- Clean Project
- Rebuild Project
- Run ▶️

#### 5. 测试
- 进入"微课视频"页面
- 应该能看到"炒菜技巧"
- 点击播放

---

## ⚠️ 常见问题

### Q1：视频文件未找到

**错误提示：**
```
视频文件未找到：
/storage/emulated/0/Documents/CampcookingAR/Videos/生火技巧.mp4

请将视频文件复制到此位置
```

**解决方法：**

1. **检查文件是否存在**
   - 打开平板的文件管理器
   - 导航到：`内部存储 > Documents > CampcookingAR > Videos`
   - 确认视频文件是否存在

2. **检查文件名是否一致**
   - `VideoConfig.kt` 中的 `fileName` 必须与实际文件名**完全一致**
   - 包括扩展名 `.mp4`
   - 区分大小写

3. **检查文件夹是否创建**
   - 运行一次应用会自动创建文件夹
   - 或手动创建：`Documents/CampcookingAR/Videos/`

### Q2：没有权限访问存储

**错误提示：**
```
Permission denied
```

**解决方法：**

1. **检查权限**
   - 在平板设置中
   - 找到应用权限
   - 确保已授予"存储"权限

2. **重新安装应用**
   - 卸载应用
   - 重新安装
   - 首次运行时授予权限

### Q3：视频无法播放

**可能原因：**

1. **视频格式不支持**
   - 解决：使用 `.mp4` 格式
   - 编码：H.264 + AAC

2. **视频文件损坏**
   - 解决：在电脑上测试视频能否播放
   - 重新复制文件

3. **文件太大**
   - 解决：压缩视频文件
   - 推荐：720p 或 1080p

### Q4：文件夹不存在

**解决方法：**

1. **运行一次应用**
   - 应用会自动创建文件夹

2. **手动创建文件夹**
   - 通过 USB 连接平板
   - 在 `Documents` 下创建 `CampcookingAR` 文件夹
   - 在 `CampcookingAR` 下创建 `Videos` 文件夹

### Q5：通过 USB 看不到平板

**解决方法：**

1. **检查 USB 模式**
   - 在平板通知栏中
   - 点击 USB 连接通知
   - 选择"文件传输"或"MTP"模式

2. **重新连接**
   - 拔掉 USB 线
   - 重新插入
   - 在平板上允许文件传输

3. **更换 USB 线或端口**
   - 使用支持数据传输的 USB 线
   - 尝试电脑的其他 USB 端口

---

## 🔧 技术细节

### 权限配置

已在 `AndroidManifest.xml` 中添加：

```xml
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_MEDIA_VIDEO" />
```

### 存储位置代码

```kotlin
// 获取 Documents 目录
val documentsDir = Environment.getExternalStoragePublicDirectory(
    Environment.DIRECTORY_DOCUMENTS
)

// 视频文件夹
val videoFolder = File(documentsDir, "CampcookingAR/Videos")

// 视频文件
val videoFile = File(videoFolder, "生火技巧.mp4")
```

### 文件夹自动创建

应用首次运行时会自动创建文件夹：

```kotlin
private fun checkVideoFolder() {
    val documentsDir = Environment.getExternalStoragePublicDirectory(
        Environment.DIRECTORY_DOCUMENTS
    )
    val videoFolder = File(documentsDir, VideoConfig.VIDEO_FOLDER)
    
    if (!videoFolder.exists()) {
        videoFolder.mkdirs()  // 自动创建
    }
}
```

---

## 📊 方案对比

| 特性 | res/raw/ 方案 | 外部存储方案 ✅ |
|------|--------------|----------------|
| 视频文件位置 | 项目内 | 平板存储 |
| GitHub 同步速度 | ❌ 慢 | ✅ 快 |
| 更新视频 | 需要重新编译 | 只需复制文件 |
| 文件名格式 | 必须小写+下划线 | 支持中文 |
| 文件大小限制 | ❌ 有限制 | ✅ 无限制 |
| 管理方便性 | ❌ 需要 Android Studio | ✅ 文件管理器 |

---

## 💡 最佳实践

### 1. 视频命名规范
```
✅ 推荐：
- 生火技巧.mp4
- 砍鸡的方法.mp4
- 01-基础技能-生火.mp4

❌ 不推荐：
- video1.mp4（不清楚内容）
- 生火技巧V2最终版修改后.mp4（太长）
```

### 2. 视频文件管理
- 按分类建立子文件夹（可选）
- 定期清理不用的视频
- 保留视频的备份

### 3. 批量更新视频
1. 准备所有新视频
2. 一次性复制到 Videos 文件夹
3. 更新 VideoConfig.kt
4. 编译运行一次
5. 测试所有视频

### 4. 多平板部署
如果有多个平板：
1. 在一个平板上准备好视频
2. 导出 Videos 文件夹
3. 批量复制到其他平板
4. 应用 APK 只需编译一次

---

## 🎯 快速检查清单

使用前检查：

- [ ] 视频文件已复制到 `Documents/CampcookingAR/Videos/`
- [ ] 视频文件名与 `VideoConfig.kt` 中的 `fileName` 一致
- [ ] 视频格式为 `.mp4`
- [ ] 应用已授予存储权限
- [ ] 已编译运行应用

---

## 📞 故障排查步骤

如果视频无法播放，按以下顺序检查：

1. ✅ 确认文件夹存在
2. ✅ 确认视频文件存在
3. ✅ 确认文件名一致
4. ✅ 确认存储权限已授予
5. ✅ 确认视频格式正确
6. ✅ 确认视频文件未损坏
7. ✅ 重启应用重试
8. ✅ 重新安装应用

---

## 🚀 视频更新工作流程

### 日常更新流程：

```
1. 准备新视频
   ↓
2. 通过 USB 复制到平板
   ↓
3. 打开 VideoConfig.kt
   ↓
4. 添加新视频配置
   ↓
5. Rebuild + Run
   ↓
6. 测试播放
   ↓
7. 完成 ✅
```

---

**实现日期：** 2026-01-01  
**方案状态：** ✅ 已完成  
**测试状态：** 请在实际设备上测试

享受便捷的视频管理体验！📁🎬

