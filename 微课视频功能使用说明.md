# 🎬 微课视频功能使用说明

## ✅ 功能已完成

微课视频页面已完成，支持本地视频播放，可容易地更换和更新视频。

---

## 📂 文件结构

```
app/src/main/
├── java/com/campcooking/ar/
│   ├── VideoActivity.kt                      # 视频页面Activity
│   ├── adapter/
│   │   └── VideoListAdapter.kt               # 视频列表适配器
│   ├── config/
│   │   └── VideoConfig.kt                    # 视频配置管理（重要！）
│   └── data/
│       └── Video.kt                          # 视频数据模型
├── res/
│   ├── layout/
│   │   ├── activity_video.xml                # 竖屏布局
│   │   ├── item_video.xml                    # 视频列表项
│   │   └── custom_player_control.xml         # 播放器控制
│   ├── layout-land/
│   │   └── activity_video.xml                # 横屏布局（主要）
│   ├── drawable/
│   │   ├── video_section_bg.xml              # 视频区背景
│   │   ├── record_section_bg.xml             # 记录区背景
│   │   └── category_tag_bg.xml               # 分类标签背景
│   └── raw/                                   # 【视频文件存放位置】
│       ├── .gitkeep
│       ├── video_fire_skills.mp4             # 示例：生火技巧视频
│       ├── video_food_prep.mp4               # 示例：食材准备视频
│       └── ... (其他视频文件)
```

---

## 🎯 如何添加/更新视频（3步完成）

### 第1步：准备视频文件

**视频要求：**
- 格式：MP4（推荐）
- 编码：H.264
- 分辨率：建议1280x720或更高
- 文件大小：建议每个视频不超过50MB
- 文件命名：使用小写字母和下划线，不要用中文

**命名示例：**
```
✅ 正确：video_fire_skills.mp4
✅ 正确：video_food_prep.mp4
✅ 正确：video_cooking_steps.mp4

❌ 错误：生火技巧.mp4（使用了中文）
❌ 错误：Video 1.mp4（有空格）
❌ 错误：video-fire.mp4（使用了连字符）
```

### 第2步：放置视频文件

将视频文件复制到：
```
app/src/main/res/raw/
```

**注意：**
- 如果 raw 文件夹不存在，请手动创建
- 视频文件名必须全小写，只能包含字母、数字和下划线
- 不要使用中文、空格或特殊字符

### 第3步：配置视频信息

打开文件：`app/src/main/java/com/campcooking/ar/config/VideoConfig.kt`

在 `getVideoList()` 方法中添加视频配置：

```kotlin
// 在列表末尾添加新视频
,
Video(
    id = 11,  // 唯一ID，递增
    title = "新视频标题",
    description = "视频详细描述\n" +
            "• 要点1\n" +
            "• 要点2\n" +
            "• 要点3",
    duration = "6:30",  // 视频时长（分:秒）
    resourceName = "video_new",  // 对应raw文件夹中的文件名（不含.mp4）
    category = "基础技能",  // 分类
    order = 11  // 显示顺序
)
```

**配置说明：**

| 字段 | 说明 | 示例 |
|------|------|------|
| id | 唯一标识，递增 | 1, 2, 3... |
| title | 视频标题 | "生火技巧" |
| description | 视频描述，支持换行 | "学习如何...\n• 要点1" |
| duration | 视频时长 | "5:30" 表示5分30秒 |
| resourceName | 文件名（不含.mp4） | "video_fire_skills" |
| category | 分类名称 | "基础技能"、"安全知识" |
| order | 排序号 | 1, 2, 3... |

---

## 📝 完整示例

### 示例1：添加"炒菜技巧"视频

**1. 准备视频文件：**
- 文件名：`video_stir_fry.mp4`
- 时长：7分20秒
- 大小：35MB

**2. 放入文件夹：**
```
将 video_stir_fry.mp4 复制到：
app/src/main/res/raw/video_stir_fry.mp4
```

**3. 添加配置：**
打开 `VideoConfig.kt`，在列表末尾添加：

```kotlin
,
Video(
    id = 11,
    title = "炒菜技巧",
    description = "学习基本的炒菜方法和技巧。包括：\n" +
            "• 油温控制\n" +
            "• 翻炒手法\n" +
            "• 调味时机\n" +
            "• 火候掌握",
    duration = "7:20",
    resourceName = "video_stir_fry",
    category = "烹饪技能",
    order = 11
)
```

**4. 重新编译运行即可！**

---

## 🎨 当前已配置的10个视频

| ID | 标题 | 时长 | 分类 | 文件名 |
|----|------|------|------|--------|
| 1 | 生火技巧 | 5:30 | 基础技能 | video_fire_skills.mp4 |
| 2 | 食材准备 | 8:45 | 基础技能 | video_food_prep.mp4 |
| 3 | 烹饪步骤 | 12:20 | 烹饪技能 | video_cooking_steps.mp4 |
| 4 | 安全须知 | 6:15 | 安全知识 | video_safety.mp4 |
| 5 | 环境保护 | 4:50 | 环保知识 | video_environment.mp4 |
| 6 | 工具使用 | 7:10 | 基础技能 | video_tools.mp4 |
| 7 | 团队协作 | 5:40 | 团队技能 | video_teamwork.mp4 |
| 8 | 经典菜品制作 | 15:30 | 烹饪技能 | video_dishes.mp4 |
| 9 | 应急处理 | 6:30 | 安全知识 | video_emergency.mp4 |
| 10 | 活动总结 | 5:00 | 总结反思 | video_summary.mp4 |

**注意：** 这些是配置示例，实际视频文件需要您自行准备并放入 raw 文件夹。

---

## 🔄 如何更新视频

### 更新视频信息（不换文件）

只修改 `VideoConfig.kt` 中的配置信息：

```kotlin
Video(
    id = 1,
    title = "生火技巧（更新版）",  // 修改标题
    description = "更新的描述...",  // 修改描述
    duration = "6:00",  // 更新时长
    resourceName = "video_fire_skills",  // 文件名不变
    category = "基础技能",
    order = 1
)
```

### 更换视频文件

1. 删除旧视频文件（或重命名）
2. 放入新视频文件（使用相同文件名）
3. 更新 `VideoConfig.kt` 中的时长信息
4. 重新编译运行

### 删除视频

1. 从 raw 文件夹删除视频文件
2. 从 `VideoConfig.kt` 中删除对应的配置
3. 重新编译运行

---

## 🎯 页面布局

### 横屏布局（10-11寸平板）

```
┌─────────────────────────────────────────────────────┐
│  [←返回] 微课视频                                     │
├─────────────────────┬───────────────────────────────┤
│                     │                               │
│  📹 视频列表        │     🎬 视频播放器             │
│                     │                               │
│  ┌───────────────┐ │     ┌─────────────────────┐   │
│  │🎥 1.生火技巧 │ │     │                     │   │
│  │   5:30        │ │     │                     │   │
│  │   [基础技能]  │ │     │   [视频画面]       │   │
│  └───────────────┘ │     │                     │   │
│  ┌───────────────┐ │     │                     │   │
│  │🎥 2.食材准备 │ │     └─────────────────────┘   │
│  │   8:45        │ │                               │
│  │   [基础技能]  │ │     标题：生火技巧             │
│  └───────────────┘ │     时长：5分30秒 [基础技能]   │
│  ┌───────────────┐ │     ─────────────────────     │
│  │🎥 3.烹饪步骤 │ │     学习如何快速安全地生火，   │
│  │   12:20       │ │     掌握柴火的摆放和点火...   │
│  │   [烹饪技能]  │ │                               │
│  └───────────────┘ │     [播放/暂停] [进度条]       │
│                     │                               │
│  (滚动查看更多)     │                               │
└─────────────────────┴───────────────────────────────┘
```

**特点：**
- 左侧30%：视频列表（可滚动）
- 右侧70%：视频播放器 + 视频信息
- 点击列表项切换视频
- 自动播放下一个视频

---

## 🎮 功能特性

### 1. 视频播放

- ✅ 使用 ExoPlayer 播放器
- ✅ 支持播放/暂停
- ✅ 支持拖动进度条
- ✅ 显示缓冲状态
- ✅ 播放完成自动播放下一个
- ✅ 全屏播放支持

### 2. 视频列表

- ✅ 显示视频标题
- ✅ 显示视频时长
- ✅ 显示分类标签
- ✅ 选中状态高亮
- ✅ 点击切换视频
- ✅ 可滚动查看

### 3. 视频信息

- ✅ 视频标题
- ✅ 视频时长
- ✅ 分类标签
- ✅ 详细描述
- ✅ 可滚动查看长描述

### 4. 错误处理

- ✅ 视频文件不存在提示
- ✅ 播放错误提示
- ✅ 加载状态显示
- ✅ 友好的错误信息

---

## 💻 技术实现

### ExoPlayer 配置

已添加依赖：
```gradle
implementation 'com.google.android.exoplayer:exoplayer:2.19.1'
```

### 视频资源加载

```kotlin
// 获取资源ID
val resourceId = resources.getIdentifier(
    video.resourceName,  // 如："video_fire_skills"
    "raw",
    packageName
)

// 构建URI
val videoUri = RawResourceDataSource.buildRawResourceUri(resourceId)

// 播放
player?.setMediaItem(MediaItem.fromUri(videoUri))
player?.prepare()
player?.play()
```

### 视频配置管理

使用 `VideoConfig.kt` 集中管理所有视频配置，便于：
- 添加新视频
- 更新视频信息
- 删除视频
- 按分类筛选
- 自定义排序

---

## 🧪 测试步骤

### 1. 准备测试视频

下载或创建几个短视频文件（建议1-2分钟）进行测试。

### 2. 放置文件

将测试视频放入 `app/src/main/res/raw/` 文件夹。

### 3. 配置信息

在 `VideoConfig.kt` 中配置对应的视频信息。

### 4. 编译运行

1. 在Android Studio中点击"Sync Project with Gradle Files"
2. 点击运行按钮
3. 从封面页进入应用
4. 填写团队信息
5. 点击"开始野炊"
6. 点击"微课视频"卡片
7. 查看视频列表和播放功能

### 5. 测试项目

- [ ] 视频列表正确显示
- [ ] 点击视频可以播放
- [ ] 播放器控制正常（播放/暂停/进度条）
- [ ] 视频信息正确显示
- [ ] 切换视频正常
- [ ] 播放完成自动播放下一个
- [ ] 返回按钮正常

---

## 🚨 常见问题

### Q1: 视频无法播放，提示"视频文件未找到"

**原因：**
- 视频文件名与配置不匹配
- 视频文件未放入 raw 文件夹
- 文件名包含特殊字符

**解决：**
1. 检查文件名是否全小写
2. 确认文件在 `app/src/main/res/raw/` 文件夹
3. 确认 `resourceName` 与文件名一致（不含.mp4）

### Q2: 添加视频后列表没有显示

**原因：**
- 未在 `VideoConfig.kt` 中添加配置
- 配置语法错误
- 未重新编译

**解决：**
1. 打开 `VideoConfig.kt`
2. 检查配置是否正确添加
3. 点击"Sync Project"重新编译

### Q3: 视频播放卡顿

**原因：**
- 视频文件太大
- 视频分辨率太高
- 编码格式不兼容

**解决：**
1. 压缩视频文件（推荐每个<50MB）
2. 降低分辨率（推荐1280x720）
3. 使用H.264编码

### Q4: 如何批量添加视频？

**步骤：**
1. 准备所有视频文件（命名规范）
2. 批量复制到 raw 文件夹
3. 复制 `VideoConfig.kt` 中的模板
4. 批量修改配置信息
5. 重新编译运行

---

## 📊 视频文件建议

### 分辨率建议

| 设备类型 | 推荐分辨率 | 说明 |
|---------|-----------|------|
| 10-11寸平板 | 1280x720 | 清晰度足够，文件适中 |
| 高端平板 | 1920x1080 | 高清画质，文件较大 |
| 老旧设备 | 854x480 | 兼容性好，文件小 |

### 码率建议

| 分辨率 | 码率 | 文件大小（10分钟） |
|--------|------|-------------------|
| 1920x1080 | 5-8 Mbps | ~400MB |
| 1280x720 | 2-4 Mbps | ~200MB |
| 854x480 | 1-2 Mbps | ~100MB |

### 转码工具推荐

- **HandBrake**（免费）- 跨平台视频转码
- **FFmpeg**（命令行）- 专业转码工具
- **格式工厂**（Windows）- 简单易用

**FFmpeg 转码示例：**
```bash
ffmpeg -i input.mp4 -vcodec h264 -acodec aac -s 1280x720 -b:v 3M output.mp4
```

---

## 🎓 进阶功能（可选）

### 1. 添加视频缩略图

在 `Video` 数据模型中添加缩略图字段，在列表中显示预览图。

### 2. 视频下载进度

如果改为网络视频，可以添加下载进度显示。

### 3. 播放记录

记录用户观看进度，下次打开继续播放。

### 4. 视频收藏

允许用户收藏常看的视频，快速访问。

### 5. 倍速播放

添加0.5x、1x、1.5x、2x等播放速度选项。

### 6. 字幕支持

为视频添加字幕文件（.srt），支持字幕显示。

---

## 📱 性能优化建议

### 1. 视频文件优化

- 使用合适的分辨率
- 使用H.264编码
- 控制码率和文件大小
- 定期清理无用视频

### 2. 内存管理

- 播放器及时释放
- 避免内存泄漏
- 使用弱引用

### 3. 用户体验

- 显示加载状态
- 缓冲时友好提示
- 错误信息明确
- 支持后台播放暂停

---

## 🔗 相关文档

- [ExoPlayer 官方文档](https://exoplayer.dev/)
- [Android VideoView 文档](https://developer.android.com/reference/android/widget/VideoView)
- [Android Resources 指南](https://developer.android.com/guide/topics/resources/providing-resources)

---

**创建日期：** 2025-12-31  
**版本：** v1.0  
**功能状态：** ✅ 已完成  
**下一步：** 准备视频文件并放入 raw 文件夹

## 🎉 开始使用吧！

现在您可以：
1. 准备10个视频文件
2. 放入 `app/src/main/res/raw/` 文件夹
3. 重新编译运行应用
4. 享受流畅的视频学习体验！

